{% extends 'flights/base.html' %}

{% block title %}–†–µ–π—Å {{ flight.number }}{% endblock %}

{% block content %}
<!-- –ó–ê–ì–û–õ–û–í–û–ö –†–ï–ô–°–ê -->
<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 10px; margin: 20px 0;">
    <h1>‚úàÔ∏è –†–µ–π—Å {{ flight.number }}</h1>
    <p><strong>–ú–∞—Ä—à—Ä—É—Ç:</strong> {{ flight.departure_city }} ‚Üí {{ flight.destination_city }}</p>
    <p><strong>–í—ã–ª–µ—Ç:</strong> {{ flight.departure_time|date:"d.m.Y H:i" }}</p>
    <p><strong>–ü—Ä–∏–±—ã—Ç–∏–µ:</strong> {{ flight.arrival_time|date:"d.m.Y H:i" }}</p>
    <p><strong>–í—ã—Ö–æ–¥:</strong> {{ flight.gate }}</p>
    <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span class="status-{{ flight.status }}">{{ flight.get_status_display }}</span></p>
    <p><strong>–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:</strong> {{ flight.capacity }} –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤</p>
</div>

<!-- –ö–ù–û–ü–ö–ê –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò –î–õ–Ø –ê–ì–ï–ù–¢–û–í -->
{% if user.is_authenticated and user.checkinagent %}
<div style="background: #27ae60; color: white; padding: 25px; border-radius: 10px; margin: 25px 0; text-align: center; border: 3px solid #2ecc71;">
    <h2 style="margin-top: 0;">üìù –°–ò–°–¢–ï–ú–ê –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò –ü–ê–°–°–ê–ñ–ò–†–û–í</h2>
    <p style="font-size: 18px; margin: 10px 0;">–ê–≥–µ–Ω—Ç: <strong>{{ user.checkinagent.workstation }}</strong> | ID: {{ user.checkinagent.agent_id }}</p>
    <a href="{% url 'flights:flight_checkin' flight.id %}" class="btn" style="background: white; color: #27ae60; font-size: 20px; padding: 18px 35px; margin: 15px 0; display: inline-block;">
        üöÄ –ü–ï–†–ï–ô–¢–ò –ö –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò
    </a>
    <p style="margin-top: 15px; font-size: 16px; opacity: 0.9;">
        –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤, –≤—ã–±–æ—Ä –º–µ—Å—Ç, –≤—ã–¥–∞—á–∞ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö —Ç–∞–ª–æ–Ω–æ–≤
    </p>
</div>
{% endif %}

<!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
<div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin: 20px 0;">
    <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–π—Å–∞</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
        <div style="text-align: center; padding: 15px; background: #e8f4fd; border-radius: 8px;">
            <div style="font-size: 24px; font-weight: bold; color: #3498db;">{{ total_passengers }}</div>
            <div>–í—Å–µ–≥–æ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤</div>
        </div>
        <div style="text-align: center; padding: 15px; background: #e8f6f3; border-radius: 8px;">
            <div style="font-size: 24px; font-weight: bold; color: #27ae60;">{{ registered_count }}</div>
            <div>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ</div>
        </div>
        <div style="text-align: center; padding: 15px; background: #fef9e7; border-radius: 8px;">
            <div style="font-size: 24px; font-weight: bold; color: #f39c12;">{{ free_seats }}</div>
            <div>–°–≤–æ–±–æ–¥–Ω—ã—Ö –º–µ—Å—Ç</div>
        </div>
        <div style="text-align: center; padding: 15px; background: #f4ecf7; border-radius: 8px;">
            <div style="font-size: 24px; font-weight: bold; color: #9b59b6;">{{ flight.capacity }}</div>
            <div>–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</div>
        </div>
    </div>
</div>

<!-- –ü–ê–°–°–ê–ñ–ò–†–´ -->
<div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin: 20px 0;">
    <h2>üë• –ü–∞—Å—Å–∞–∂–∏—Ä—ã —Ä–µ–π—Å–∞</h2>

    {% if passenger_data %}
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; margin-top: 20px;">
            {% for data in passenger_data %}
            <div style="border: 2px solid {% if data.is_registered %}#27ae60{% else %}#f39c12{% endif %}; padding: 20px; border-radius: 10px; background: {% if data.is_registered %}#f8fff8{% else %}#fffbf0{% endif %};">
                <h4 style="margin: 0 0 12px 0; color: #2c3e50;">{{ data.passenger.first_name }} {{ data.passenger.last_name }}</h4>
                <p style="margin: 8px 0;"><strong>üìá –ü–∞—Å–ø–æ—Ä—Ç:</strong> {{ data.passenger.passport_number }}</p>
                <p style="margin: 8px 0;"><strong>üí∫ –ú–µ—Å—Ç–æ:</strong> {{ data.passenger.seat_number }}</p>

                {% if data.is_registered %}
                <div style="background: #d4edda; padding: 12px; border-radius: 6px; margin-top: 15px; border-left: 4px solid #27ae60;">
                    <div style="font-weight: bold; color: #155724;">‚úÖ –ó–ê–†–ï–ì–ò–°–¢–†–ò–†–û–í–ê–ù</div>
                    <div style="margin-top: 8px; font-size: 14px;">
                        <strong>–ü–æ—Å–∞–¥–æ—á–Ω—ã–π —Ç–∞–ª–æ–Ω:</strong> {{ data.boarding_pass.boarding_pass_number }}<br>
                        <strong>–ú–µ—Å—Ç–æ –ø–æ—Å–∞–¥–∫–∏:</strong> {{ data.boarding_pass.seat_number }}<br>
                        <strong>–í—ã—Ö–æ–¥:</strong> {{ data.boarding_pass.gate }}
                    </div>
                </div>
                {% else %}
                <div style="background: #fff3cd; padding: 12px; border-radius: 6px; margin-top: 15px; border-left: 4px solid #ffc107;">
                    <div style="font-weight: bold; color: #856404;">‚è≥ –û–ñ–ò–î–ê–ï–¢ –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò</div>
                    <div style="margin-top: 8px; font-size: 14px;">
                        –ü–∞—Å—Å–∞–∂–∏—Ä –µ—â–µ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Ä–µ–π—Å
                    </div>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div style="text-align: center; padding: 40px;">
            <h3 style="color: #6c757d;">üò¥ –ù–∞ —ç—Ç–æ–º —Ä–µ–π—Å–µ –ø–æ–∫–∞ –Ω–µ—Ç –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤</h3>
            <p>–î–æ–±–∞–≤—å—Ç–µ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</p>

            {% if user.is_authenticated and user.checkinagent %}
            <div style="margin-top: 25px;">
                <a href="/admin/flights/passenger/add/" class="btn" style="background: #3498db; padding: 12px 25px;">
                    ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Å—Å–∞–∂–∏—Ä–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É
                </a>
            </div>
            {% endif %}
        </div>
    {% endif %}
</div>

<!-- –ë–´–°–¢–†–´–ï –î–ï–ô–°–¢–í–ò–Ø -->
<div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
    <h3>üöÄ –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
    <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-top: 20px;">
        <a href="{% url 'flights:flight_list' %}" class="btn" style="background: #3498db;">
            üìã –í—Å–µ —Ä–µ–π—Å—ã
        </a>

        {% if user.is_authenticated and user.checkinagent %}
        <a href="{% url 'flights:agent_dashboard' %}" class="btn" style="background: #9b59b6;">
            üë®‚Äçüíº –ü–∞–Ω–µ–ª—å –∞–≥–µ–Ω—Ç–∞
        </a>
        <a href="{% url 'flights:flight_checkin' flight.id %}" class="btn" style="background: #27ae60;">
            üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤
        </a>
        <a href="{% url 'flights:passenger_lookup' %}" class="btn" style="background: #e67e22;">
            üîç –ü–æ–∏—Å–∫ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤
        </a>
        {% endif %}

        <a href="/admin/flights/flight/{{ flight.id }}/change/" class="btn" style="background: #95a5a6;">
            ‚öôÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–π—Å
        </a>
    </div>
</div>

<style>
.btn {
    display: inline-block;
    padding: 14px 24px;
    margin: 5px;
    border-radius: 8px;
    text-decoration: none;
    color: white;
    font-weight: bold;
    border: none;
    cursor: pointer;
    text-align: center;
    transition: all 0.3s ease;
    font-size: 16px;
}
.btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.15);
}
.status-scheduled { color: #3498db; font-weight: bold; }
.status-boarding { color: #f39c12; font-weight: bold; }
.status-departed { color: #e74c3c; font-weight: bold; }
.status-landed { color: #27ae60; font-weight: bold; }
.status-cancelled { color: #95a5a6; font-weight: bold; }
</style>
{% endblock %}