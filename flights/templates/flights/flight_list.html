{% extends 'flights/base.html' %}

{% block title %}–í—Å–µ —Ä–µ–π—Å—ã{% endblock %}

{% block content %}
<h2>üìã –°–ø–∏—Å–æ–∫ —Ä–µ–π—Å–æ–≤</h2>



<!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ -->
<form method="get" style="background: white; padding: 15px; border-radius: 5px;">
    <input type="text" name="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É —Ä–µ–π—Å–∞..." value="{{ search_query }}">
    <select name="status">
        <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
        <option value="scheduled" {% if status_filter == 'scheduled' %}selected{% endif %}>–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω</option>
        <option value="boarding" {% if status_filter == 'boarding' %}selected{% endif %}>–ü–æ—Å–∞–¥–∫–∞</option>
        <option value="departed" {% if status_filter == 'departed' %}selected{% endif %}>–í—ã–ª–µ—Ç–µ–ª</option>
        <option value="landed" {% if status_filter == 'landed' %}selected{% endif %}>–ü—Ä–∏–∑–µ–º–ª–∏–ª—Å—è</option>
        <option value="cancelled" {% if status_filter == 'cancelled' %}selected{% endif %}>–û—Ç–º–µ–Ω–µ–Ω</option>
    </select>
    <button type="submit">üîç –ù–∞–π—Ç–∏</button>
</form>

<!-- –°–ü–ò–°–û–ö –†–ï–ô–°–û–í -->
{% if flights %}
    {% for flight in flights %}
    <div class="flight-item">
        <h3>
            <a href="{% url 'flights:flight_detail' flight.id %}" style="text-decoration: none; color: #2c3e50;">
                ‚úàÔ∏è –†–µ–π—Å {{ flight.number }}: {{ flight.departure_city }} ‚Üí {{ flight.destination_city }}
            </a>
        </h3>
        <p><strong>üïê –í—ã–ª–µ—Ç:</strong> {{ flight.departure_time|date:"d.m.Y H:i" }}</p>
        <p><strong>üïê –ü—Ä–∏–±—ã—Ç–∏–µ:</strong> {{ flight.arrival_time|date:"d.m.Y H:i" }}</p>
        <p><strong>üìä –°—Ç–∞—Ç—É—Å:</strong>
            <span class="status-{{ flight.status }}">
                {{ flight.get_status_display }}
            </span>
        </p>
        <p><strong>üö™ –í—ã—Ö–æ–¥:</strong> {{ flight.gate }}</p>
        <p><strong>üë• –í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:</strong> {{ flight.capacity }} –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤</p>

        <!-- –î–ª—è –∞–≥–µ–Ω—Ç–æ–≤ - –∫–Ω–æ–ø–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        {% if user.is_authenticated and user.checkinagent %}
        <div style="margin-top: 10px;">
            <a href="{% url 'flights:flight_checkin' flight.id %}" class="btn" style="background: #27ae60;">
                üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤
            </a>
        </div>
        {% endif %}
    </div>
    {% endfor %}
{% else %}
    <div style="background: white; padding: 30px; border-radius: 5px; text-align: center;">
        <h3 style="color: #e74c3c;">‚ùå –†–µ–π—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
        <p>–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:</p>
        <ul style="text-align: left; display: inline-block; margin: 15px 0;">
            <li>–ù–µ—Ç —Ä–µ–π—Å–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö</li>
            <li>–ê–∫—Ç–∏–≤–µ–Ω —Ñ–∏–ª—å—Ç—Ä –ø–æ–∏—Å–∫–∞</li>
            <li>–†–µ–π—Å—ã –∏–º–µ—é—Ç –ø—Ä–æ—à–µ–¥—à–∏–µ –¥–∞—Ç—ã</li>
        </ul>
        <div style="margin-top: 20px;">
            <a href="{% url 'flights:flight_list' %}" class="btn" style="background: #3498db;">
                üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
            </a>
            <a href="/admin/flights/flight/add/" class="btn" style="background: #9b59b6;">
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–π—Å
            </a>
        </div>
    </div>
{% endif %}

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
{% if flights %}
<div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin-top: 20px;">
    <strong>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</strong>
    –í—Å–µ–≥–æ —Ä–µ–π—Å–æ–≤: {{ flights|length }}
    {% if flights|length > 0 %}
        | –ü–µ—Ä–≤—ã–π –≤—ã–ª–µ—Ç: {{ flights.0.departure_time|date:"H:i" }}

    {% endif %}
</div>
{% endif %}

<style>
.btn {
    display: inline-block;
    padding: 10px 15px;
    margin: 5px;
    border-radius: 5px;
    text-decoration: none;
    color: white;
    font-weight: bold;
    border: none;
    cursor: pointer;
}
.btn:hover {
    opacity: 0.9;
}
.flight-item {
    border: 1px solid #ddd;
    padding: 20px;
    margin: 15px 0;
    border-radius: 5px;
    background: white;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.status-scheduled { color: #3498db; }
.status-boarding { color: #f39c12; }
.status-departed { color: #e74c3c; }
.status-landed { color: #27ae60; }
.status-cancelled { color: #95a5a6; }
</style>
{% endblock %}